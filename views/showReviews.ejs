<%- include("partials/header") %>

<% if (error.length > 0) { %>
<div class="ui negative message">
    <div class="header"><%= error %></div>
</div>
<% } %>

<% if (success.length > 0) { %>
<div class="ui positive message">
    <div class="header"><%= success %></div>
</div>
<% } %>

<section id="reviews_parentContainer">

    <div id="reviews_parentInnerContainer">
        <h3 id="reviews_title">reviews for: <%= campground.campname %></h3>

        <div id="reviews_items" class="ui items">

            <%if(campground.reviews.length === 0) { %>
            <h3>There are no reviews for this post yet.</h3>
            <% } %>

            <% campground.reviews.forEach(review => { %>
            <div id="reviews_item" class="item">
                <a class="ui tiny image">
                    <img src="<%= review.author.avatar %>">
                </a>
                <div class="content">
                    <a class="header" href="/campgrounds/users/<%= review.author._id %>">
                        @<%= review.author.username %>
                    </a>

                    <% if(user !== undefined) {%>
                    <% if(JSON.stringify(review.author._id) === JSON.stringify(user.id))  { %>
                    <form action="/campgrounds/camps/<%=campground._id%>/reviews/<%=review._id%>?_method=DELETE"
                        method="POST" id="reviews_deleteForm">
                        <button id="reviews_deleteButton" class="ui red button" type='submit'>Delete</button>

                        <a href="/campgrounds/camps/<%=campground._id%>/reviews/<%=review._id%>/edit">
                            <button id="reviews_updateButton" class="ui blue button" type="button">Update</button>
                        </a>
                    </form>
                    <% } %>
                    <% } %>

                    <div class="meta">
                        <span>Rating: <%= review.rating %> <i class="star icon"></i> </span>
                    </div>
                    <div class="description">
                        <p><%= review.text %></p>
                    </div>
                </div>
            </div>
            <% }) %>
        </div>
    </div>
</section>

<%- include("partials/footer") %>